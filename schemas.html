<!DOCTYPE html>
<html lang="en">
  <head><meta name="generator" content="Hexo 3.9.0">
    <meta charset="utf-8">

    <!-- Basic -->
    <title>Schemas & Collections | Vulcan Docs</title>
    <meta name="description" content>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="shortcut icon" type="image/png" href="images/favicon.ico" sizes="16x16 32x32 64x64">

    <!-- Social -->
    <meta property="og:type" content="article">
    <meta property="og:url" content="https://docs.vulcanjs.org">
    <meta property="og:title" content="Schemas & Collections | Vulcan Docs">
    <meta property="og:description" content>
    <meta property="og:image" content>
    <meta name="twitter:card" content="summary_image_large">
    <meta name="twitter:site" content="@vulcanjs">
    <meta name="twitter:title" content="Schemas & Collections | Vulcan Docs">
    <meta name="twitter:description" content>
    <meta name="twitter:image" content>

    <!-- Misc -->
    <meta name="google-site-verification" content>
    <link rel="preconnect" href="https://fonts.gstatic.com/" crossorigin>
    <link href="https://fonts.googleapis.com/css?family=Source+Sans+Pro:400,300,200,300italic,400italic" rel="stylesheet" type="text/css">
    <link rel="stylesheet" href="/style/style.css">

    <link rel="stylesheet" href="https://cdn.jsdelivr.net/docsearch.js/2/docsearch.min.css">


  </head>
  <body class>
    

<div class="nav dark">
  <div class="nav-group">
    <div class="nav-item show-mobile">
      <span class="js-sidebar-toggle ">
        <span class="icon-menu"></span>
      </span>
    </div>
    <div class="nav-item">
      <a class="logo-wrapper" href="https://docs.vulcanjs.org/" title="Vulcan Documentation Vulcan Documentation">
        <img src="/images/vulcan-logo-border-2.svg" alt="Vulcan Documentation" class="logo">
        <span>Vulcan Documentation</span>
      </a>
    </div>
  </div>

  <div class="nav-group right">

    <div class="nav-item wrapper-search">
      <div class="input-symbol small round">
        <input type="text" placeholder="Search Vulcan Docs" id="desktop-search-input">
        <span class="icon-search"></span>
      </div>
      <div class="wrapper-desktop-search-results"></div>
    </div>

    
      
      <div class="nav-item show-desktop false ">
        <a class="link" href="https://github.com/vulcanjs/vulcan">
          <span>GitHub</span>
        </a>
      </div>
    
      
      <div class="nav-item show-desktop false ">
        <a class="link" href="http://slack.vulcanjs.org">
          <span>Slack</span>
        </a>
      </div>
    
  </div>
</div>

<div class="sidebar">
  <div class="panel">
    <div class="panel-item">
      <a class href="https://docs.vulcanjs.org/" title="Vulcan Documentation">
        <span>Vulcan Documentation Vulcan Documentation</span>
      </a>
    </div>
    
      <div class="panel-item " ">
        <a class href="https://github.com/vulcanjs/vulcan">
          <span>GitHub</span>
        </a>
      </div>
    
      <div class="panel-item " ">
        <a class href="http://slack.vulcanjs.org">
          <span>Slack</span>
        </a>
      </div>
    
  </div>

  <div class="sidebar-content">
    <div class="topcap">
      
    </div>

    <ul class="toc">
      
        <li>
          
          <ul class="list-toc">
            
              
              <li class="item-toc ">
                <a href="index.html" class="sidebar-link ">
                  <span>Read Me</span>
                </a>
              </li>
            
              
              <li class="item-toc ">
                <a href="nutshell.html" class="sidebar-link ">
                  <span>Vulcan in a Nutshell</span>
                </a>
              </li>
            
              
              <li class="item-toc ">
                <a href="toc.html" class="sidebar-link ">
                  <span>Table of Contents</span>
                </a>
              </li>
            
          </ul>
        </li>
      
        <li>
          
            <div class="heading-toc">Schemas</div>
          
          <ul class="list-toc">
            
              
              <li class="item-toc  current">
                <a href class="sidebar-link  current">
                  <span>Schemas & Collections</span>
                </a>
              </li>
            
              
              <li class="item-toc ">
                <a href="schema-properties.html" class="sidebar-link ">
                  <span>Schema Properties</span>
                </a>
              </li>
            
              
              <li class="item-toc ">
                <a href="field-resolvers.html" class="sidebar-link ">
                  <span>Field Resolvers</span>
                </a>
              </li>
            
              
              <li class="item-toc ">
                <a href="relations.html" class="sidebar-link ">
                  <span>Relations</span>
                </a>
              </li>
            
          </ul>
        </li>
      
        <li>
          
            <div class="heading-toc">GraphQL API</div>
          
          <ul class="list-toc">
            
              
              <li class="item-toc ">
                <a href="graphql-schema.html" class="sidebar-link ">
                  <span>GraphQL Schema</span>
                </a>
              </li>
            
              
              <li class="item-toc ">
                <a href="queries.html" class="sidebar-link ">
                  <span>Queries</span>
                </a>
              </li>
            
              
              <li class="item-toc ">
                <a href="filtering.html" class="sidebar-link ">
                  <span>Filtering</span>
                </a>
              </li>
            
              
              <li class="item-toc ">
                <a href="mutations.html" class="sidebar-link ">
                  <span>Mutations</span>
                </a>
              </li>
            
              
              <li class="item-toc ">
                <a href="fragments.html" class="sidebar-link ">
                  <span>Fragments</span>
                </a>
              </li>
            
              
              <li class="item-toc ">
                <a href="server-queries.html" class="sidebar-link ">
                  <span>Querying on the Server</span>
                </a>
              </li>
            
              
              <li class="item-toc ">
                <a href="connecting-remotely.html" class="sidebar-link ">
                  <span>Connecting Remotely</span>
                </a>
              </li>
            
          </ul>
        </li>
      
        <li>
          
            <div class="heading-toc">Features</div>
          
          <ul class="list-toc">
            
              
              <li class="item-toc ">
                <a href="routing.html" class="sidebar-link ">
                  <span>Routing</span>
                </a>
              </li>
            
              
              <li class="item-toc ">
                <a href="settings.html" class="sidebar-link ">
                  <span>Settings</span>
                </a>
              </li>
            
              
              <li class="item-toc ">
                <a href="groups-permissions.html" class="sidebar-link ">
                  <span>Groups & Permissions</span>
                </a>
              </li>
            
              
              <li class="item-toc ">
                <a href="callbacks.html" class="sidebar-link ">
                  <span>Callbacks</span>
                </a>
              </li>
            
              
              <li class="item-toc ">
                <a href="users.html" class="sidebar-link ">
                  <span>Users</span>
                </a>
              </li>
            
              
              <li class="item-toc ">
                <a href="internationalization.html" class="sidebar-link ">
                  <span>Internationalization</span>
                </a>
              </li>
            
              
              <li class="item-toc ">
                <a href="head-tags.html" class="sidebar-link ">
                  <span>Head Tags</span>
                </a>
              </li>
            
              
              <li class="item-toc ">
                <a href="errors.html" class="sidebar-link ">
                  <span>Errors & Messages</span>
                </a>
              </li>
            
          </ul>
        </li>
      
        <li>
          
            <div class="heading-toc">Components</div>
          
          <ul class="list-toc">
            
              
              <li class="item-toc ">
                <a href="components.html" class="sidebar-link ">
                  <span>Components</span>
                </a>
              </li>
            
              
              <li class="item-toc ">
                <a href="ui-components.html" class="sidebar-link ">
                  <span>UI Components</span>
                </a>
              </li>
            
              
              <li class="item-toc ">
                <a href="datatable.html" class="sidebar-link ">
                  <span>Datatable</span>
                </a>
              </li>
            
              
              <li class="item-toc ">
                <a href="card.html" class="sidebar-link ">
                  <span>Card</span>
                </a>
              </li>
            
              
              <li class="item-toc ">
                <a href="forms-components.html" class="sidebar-link ">
                  <span>Form Components</span>
                </a>
              </li>
            
              
              <li class="item-toc ">
                <a href="other-components.html" class="sidebar-link ">
                  <span>Other Components</span>
                </a>
              </li>
            
          </ul>
        </li>
      
        <li>
          
            <div class="heading-toc">Forms</div>
          
          <ul class="list-toc">
            
              
              <li class="item-toc ">
                <a href="forms.html" class="sidebar-link ">
                  <span>Forms</span>
                </a>
              </li>
            
              
              <li class="item-toc ">
                <a href="decorators.html" class="sidebar-link ">
                  <span>Field Decorators</span>
                </a>
              </li>
            
              
              <li class="item-toc ">
                <a href="forms-custom.html" class="sidebar-link ">
                  <span>Custom Form Components</span>
                </a>
              </li>
            
          </ul>
        </li>
      
        <li>
          
            <div class="heading-toc">Server</div>
          
          <ul class="list-toc">
            
              
              <li class="item-toc ">
                <a href="performance.html" class="sidebar-link ">
                  <span>Performance</span>
                </a>
              </li>
            
              
              <li class="item-toc ">
                <a href="database.html" class="sidebar-link ">
                  <span>Database Layer</span>
                </a>
              </li>
            
          </ul>
        </li>
      
        <li>
          
            <div class="heading-toc">Other Packages</div>
          
          <ul class="list-toc">
            
              
              <li class="item-toc ">
                <a href="packages.html" class="sidebar-link ">
                  <span>Packages Types</span>
                </a>
              </li>
            
              
              <li class="item-toc ">
                <a href="email.html" class="sidebar-link ">
                  <span>Email</span>
                </a>
              </li>
            
              
              <li class="item-toc ">
                <a href="events.html" class="sidebar-link ">
                  <span>Analytics & Event Tracking</span>
                </a>
              </li>
            
              
              <li class="item-toc ">
                <a href="error-tracking.html" class="sidebar-link ">
                  <span>Error Tracking</span>
                </a>
              </li>
            
              
              <li class="item-toc ">
                <a href="debug.html" class="sidebar-link ">
                  <span>Debugging</span>
                </a>
              </li>
            
          </ul>
        </li>
      
        <li>
          
            <div class="heading-toc">Testing</div>
          
          <ul class="list-toc">
            
              
              <li class="item-toc ">
                <a href="unit-testing.html" class="sidebar-link ">
                  <span>Unit Testing</span>
                </a>
              </li>
            
              
              <li class="item-toc ">
                <a href="storybook.html" class="sidebar-link ">
                  <span>Storybook</span>
                </a>
              </li>
            
          </ul>
        </li>
      
        <li>
          
            <div class="heading-toc">Resources</div>
          
          <ul class="list-toc">
            
              
              <li class="item-toc ">
                <a href="learn.html" class="sidebar-link ">
                  <span>Learn More</span>
                </a>
              </li>
            
              
              <li class="item-toc ">
                <a href="examples.html" class="sidebar-link ">
                  <span>Examples</span>
                </a>
              </li>
            
              
              <li class="item-toc ">
                <a href="common-problems.html" class="sidebar-link ">
                  <span>Common Problems</span>
                </a>
              </li>
            
              
              <li class="item-toc ">
                <a href="plugins.html" class="sidebar-link ">
                  <span>Plugins</span>
                </a>
              </li>
            
              
              <li class="item-toc ">
                <a href="themes.html" class="sidebar-link ">
                  <span>Themes</span>
                </a>
              </li>
            
              
              <li class="item-toc ">
                <a href="tutorials.html" class="sidebar-link ">
                  <span>Tutorials</span>
                </a>
              </li>
            
              
              <li class="item-toc ">
                <a href="videos.html" class="sidebar-link ">
                  <span>Videos</span>
                </a>
              </li>
            
          </ul>
        </li>
      
    </ul>
  </div>
</div>

<div class="content">
  <div class="content-wrapper">
    <div class="header-content">
      <h1 class="title-page">Schemas & Collections</h1>
      

      <div class="page-actions">
        <div class="actions-group">
          <a class="btn tertiary small round lowercase" href="https://github.com/vulcanjs/vulcan-docs/tree/master/source/schemas.md" target="_blank"><span class="icon-github"></span> <span>Edit on GitHub</span></a>
          
        </div>
      </div>
    </div>

    <div class="document-formatting">
      <p>The role of the schema is to serve as a central source of truth that will be used to generate or populate many of Vulcan’s other components.</p>
<p><img src="/images/vulcan-schemas.svg" alt="/images/vulcan-schemas.svg"></p>
<p>Based on your schema, Vulcan can:</p>
<ul>
<li>Generate a GraphQL equivalent of your schema to control your GraphQL API.</li>
<li><a href="/groups-permissions.html">Control permissions</a> for accessing and modifying data.</li>
<li><a href="/forms.html">Generate forms</a> on the client.</li>
<li>Validate form contents on submission.</li>
<li>Auto-generate <a href="/datatable.html">paginated, searchable datatables</a>.</li>
<li>Auto-generate <a href="/card.html">smart cards</a> for displaying individual documents.</li>
<li>Add callbacks on document insert or edit.</li>
</ul>
<h2 id="Schemas"><a href="#Schemas" class="headerlink" title="Schemas"></a>Schemas</h2><p>Here is a schema example, taken from the <a href="/example-movies.html">Movies tutorial</a>:</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> schema = &#123;</span><br><span class="line">  _id: &#123;</span><br><span class="line">    type: <span class="built_in">String</span>,</span><br><span class="line">    optional: <span class="literal">true</span>,</span><br><span class="line">    canRead: [<span class="string">'guests'</span>]</span><br><span class="line">  &#125;,</span><br><span class="line">  createdAt: &#123;</span><br><span class="line">    type: <span class="built_in">Date</span>,</span><br><span class="line">    optional: <span class="literal">true</span>,</span><br><span class="line">    canRead: [<span class="string">'guests'</span>],</span><br><span class="line">    onCreate: <span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">      <span class="keyword">return</span> <span class="keyword">new</span> <span class="built_in">Date</span>();</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">  userId: &#123;</span><br><span class="line">    type: <span class="built_in">String</span>,</span><br><span class="line">    optional: <span class="literal">true</span>,</span><br><span class="line">    canRead: [<span class="string">'guests'</span>],</span><br><span class="line">    resolveAs: &#123;</span><br><span class="line">      fieldName: <span class="string">'user'</span>,</span><br><span class="line">      type: <span class="string">'User'</span>,</span><br><span class="line">      relation: <span class="string">'hasOne'</span>,</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">  name: &#123;</span><br><span class="line">    type: <span class="built_in">String</span>,</span><br><span class="line">    optional: <span class="literal">true</span>,</span><br><span class="line">    canRead: [<span class="string">'guests'</span>],</span><br><span class="line">    canCreate: [<span class="string">'members'</span>],</span><br><span class="line">    canUpdate: [<span class="string">'members'</span>]</span><br><span class="line">  &#125;,</span><br><span class="line">  year: &#123;</span><br><span class="line">    type: <span class="built_in">String</span>,</span><br><span class="line">    optional: <span class="literal">true</span>,</span><br><span class="line">    canRead: [<span class="string">'guests'</span>],</span><br><span class="line">    canCreate: [<span class="string">'members'</span>],</span><br><span class="line">    canUpdate: [<span class="string">'members'</span>]</span><br><span class="line">  &#125;,</span><br><span class="line">  review: &#123;</span><br><span class="line">    type: <span class="built_in">String</span>,</span><br><span class="line">    optional: <span class="literal">true</span>,</span><br><span class="line">    canRead: [<span class="string">'guests'</span>],</span><br><span class="line">    canCreate: [<span class="string">'members'</span>],</span><br><span class="line">    canUpdate: [<span class="string">'members'</span>],</span><br><span class="line">    input: <span class="string">'textarea'</span>,</span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<p>As you can see, a schema is a JavaScript object containing a list of fields, each of which is defined using a range of special properties.</p>
<h2 id="Creating-Collections"><a href="#Creating-Collections" class="headerlink" title="Creating Collections"></a>Creating Collections</h2><p>Vulcan features a number of helpers to make setting up your layer faster, most of which are initialized through the <code>createCollection</code> function:</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> Movies = createCollection(&#123;</span><br><span class="line">  typeName: <span class="string">'Movie'</span>,</span><br><span class="line"></span><br><span class="line">  collectionName: <span class="string">'Movies'</span>,</span><br><span class="line"></span><br><span class="line">  schema,</span><br><span class="line"></span><br><span class="line">  resolvers,</span><br><span class="line"></span><br><span class="line">  mutations,</span><br><span class="line"></span><br><span class="line">  permissions,</span><br><span class="line"></span><br><span class="line">  filters, </span><br><span class="line"></span><br><span class="line">  defaultInput,</span><br><span class="line"></span><br><span class="line">  components,</span><br><span class="line"></span><br><span class="line">  generateGraphQLSchema, </span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<p>The function takes the following arguments:</p>
<ul>
<li><code>typeName</code>: the name of the GraphQL type that will be generated for the collection.</li>
<li><code>collectionName</code>: optionally, the name of the collection throughout your app (will be lowercased in your MongoDB database). If not provided it will be the plural of your type name.</li>
<li><code>dbCollectionName</code>: if you want to use a different name in your database you can specify it here.</li>
<li><code>schema</code>, <code>resolvers</code>, <code>mutations</code>: see below.</li>
<li><code>permissions</code>: an object defining the collection’s document-level permissions</li>
<li><code>filters</code>: an object defining filters to enhance collection queries.</li>
<li><code>defaultInput</code>: an object defining the collection’s default query input.</li>
<li><code>components</code>: an object containing helper components.</li>
<li><code>resolvers</code> (optional): an object containing <code>single</code> and <code>multi</code> query resolvers.</li>
<li><code>mutations</code> (optional): an object containing <code>create</code>, <code>update</code>, <code>upsert</code>, and <code>delete</code> mutation resolvers.</li>
<li><code>generateGraphQLSchema</code>: whether to use the objects passed above to automatically generate the GraphQL schema or not (defaults to <code>true</code>).</li>
</ul>
<p>Note that if you do not specify <code>resolvers</code> or <code>mutations</code>, default query resolvers and mutation resolvers will be generated for you. </p>
<h4 id="Alternative-Approach"><a href="#Alternative-Approach" class="headerlink" title="Alternative Approach"></a>Alternative Approach</h4><p>Passing a schema, a resolver, and a mutation to <code>createCollection</code> enables a lot of Vulcan’s internal synergy. That being said, you can also set <code>generateGraphQLSchema</code> to <code>false</code> and use the custom schemas, custom resolvers, and custom mutations utilities documented below to bypass this if you prefer.</p>
<h2 id="Extending-Collections"><a href="#Extending-Collections" class="headerlink" title="Extending Collections"></a>Extending Collections</h2><p>You can extend a collection’s options with <code>extendCollection(collection, options)</code>. For example:</p>
<figure class="highlight less"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-tag">extendCollection</span>(Posts, &#123; </span><br><span class="line">  <span class="attribute">callbacks</span>: &#123; </span><br><span class="line">    <span class="attribute">create</span>: &#123;</span><br><span class="line">      <span class="attribute">after</span>: [ notifyAdmins ]</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<p>This can be useful when you want to declare a collection in a file shared by both client and server, but want to add some options (such as callbacks) only on the server.</p>
<p>Note that this works for all options except the schema, which is initialized with the initial <code>createCollection</code>. To extend the schema, see <code>addField</code> below.</p>
<h2 id="Extending-Schemas"><a href="#Extending-Schemas" class="headerlink" title="Extending Schemas"></a>Extending Schemas</h2><p>Sometimes, you’ll want to extend an existing schema. For example Vulcan’s <a href="/example-forum.html">Forum example</a> has three main collections: <code>Posts</code>, <code>Users</code>, and <code>Comments</code>. Each of them has a pre-set schema, but that schema can also be extended with custom fields.</p>
<p>This is how the <code>vulcan:newsletter</code> package extends the <code>Posts</code> schema with a <code>scheduledAt</code> property that keeps track of when a post was sent out as part of an email newsletter:</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">Posts.addField(&#123;</span><br><span class="line">  fieldName: <span class="string">'scheduledAt",</span></span><br><span class="line"><span class="string">  fieldSchema: &#123;</span></span><br><span class="line"><span class="string">    type: Date,</span></span><br><span class="line"><span class="string">    optional: true</span></span><br><span class="line"><span class="string">  &#125;</span></span><br><span class="line"><span class="string">&#125;);</span></span><br></pre></td></tr></table></figure>

<p>The <code>collection.addField()</code> function takes either a field object, or an array of fields. Each field has a <code>fieldName</code> property, and a <code>fieldSchema</code> property.</p>
<p>Each field schema supports all of the <a href="https://github.com/aldeed/simple-schema-js" target="_blank" rel="noopener">SimpleSchema properties</a>, such as <code>type</code>, <code>optional</code>, etc.</p>
<p>A few special properties (<code>canRead</code>, <code>canCreate</code>, <code>canUpdate</code>, <code>input</code>, and <code>order</code>) are also supported by the <a href="forms.html">Forms</a> package.</p>
<p>You can also remove a field by calling <code>collection.removeField(fieldName)</code>. For example:</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Posts.removeField(<span class="string">"scheduledAt"</span>);</span><br></pre></td></tr></table></figure>

<h2 id="Nested-Schemas"><a href="#Nested-Schemas" class="headerlink" title="Nested Schemas"></a>Nested Schemas</h2><p>Your collection’s basic schema is flat, but in some cases you might want to validate your data and specify its shape multiple levels deep. The two main cases where this is useful is when: </p>
<ol>
<li>You are storing your data in a nested shape in your database.</li>
<li>You are using custom resolvers to load complex objects and would like to give them GraphQL types. </li>
</ol>
<p>In either case, the first step is to define a new schema for your nested data, in this case customer addresses. </p>
<p>Note that while you can pass a “raw” schema object to a collection directly, in other cases (such as when being used as sub-schema) it’s necessary to initialize schemas to transform them into actual schema objects using the <code>createSchema</code> function: </p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; createSchema &#125; <span class="keyword">from</span> <span class="string">'meteor/vulcan:core'</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> addressSchema = createSchema(&#123;</span><br><span class="line">  street: &#123;</span><br><span class="line">    type: <span class="built_in">String</span>,</span><br><span class="line">    optional: <span class="literal">false</span>,</span><br><span class="line">    canRead: [<span class="string">'guests'</span>],</span><br><span class="line">    canCreate: [<span class="string">'members'</span>],</span><br><span class="line">    canUpdate: [<span class="string">'members'</span>],</span><br><span class="line">    max: <span class="number">100</span>, <span class="comment">// limit street address to 100 characters</span></span><br><span class="line">  &#125;,</span><br><span class="line">  country: &#123;</span><br><span class="line">    type: <span class="built_in">String</span>,</span><br><span class="line">    optional: <span class="literal">true</span>,</span><br><span class="line">    canRead: [<span class="string">'guests'</span>],</span><br><span class="line">    canCreate: [<span class="string">'members'</span>],</span><br><span class="line">    canUpdate: [<span class="string">'members'</span>],</span><br><span class="line">  &#125;,</span><br><span class="line">  zipCode: &#123;</span><br><span class="line">    type: <span class="built_in">Number</span>,</span><br><span class="line">    optional: <span class="literal">true</span>,</span><br><span class="line">    canRead: [<span class="string">'guests'</span>],</span><br><span class="line">    canCreate: [<span class="string">'members'</span>],</span><br><span class="line">    canUpdate: [<span class="string">'members'</span>],</span><br><span class="line">    input: <span class="string">'number'</span>,</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<p>Note that nested schemas also need their own <code>canRead</code>, <code>canCreate</code>, etc. properties. </p>
<p>You can then call that schema from your main collection schema:</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> schema = &#123;</span><br><span class="line">  _id: &#123;</span><br><span class="line">    type: <span class="built_in">String</span>,</span><br><span class="line">    optional: <span class="literal">true</span>,</span><br><span class="line">    canRead: [<span class="string">'guests'</span>],</span><br><span class="line">  &#125;,</span><br><span class="line">  </span><br><span class="line">  <span class="comment">//...</span></span><br><span class="line"></span><br><span class="line">  addresses: &#123;</span><br><span class="line">    type: <span class="built_in">Array</span>,</span><br><span class="line">    canRead: [<span class="string">'guests'</span>],</span><br><span class="line">    canCreate: [<span class="string">'members'</span>],</span><br><span class="line">    canUpdate: [<span class="string">'members'</span>],</span><br><span class="line">  &#125;,</span><br><span class="line"></span><br><span class="line">  <span class="string">'addresses.$'</span>: &#123;</span><br><span class="line">    type: addressSchema,</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<p>The resulting type’s name will be <code>${typeName}${fieldName}</code>, which in this case means a new <code>CustomerAddresses</code> GraphQL type will automatically be created for you. </p>
<p>Note that currently there is no way to reuse nested GraphQL schemas, meaning two <code>shippingAddress</code> and <code>billingAddress</code> fields will generate two <code>CustomerShippingAddress</code> and <code>CustomerBillingAddress</code> GraphQL types even if the underlying JavaScript sub-schemas objects are the same.</p>
<p>The previous example assumes that the <code>addresses</code> data is stored in your database, but if you’re getting it through a resolved field instead you will have to specify your type manually:</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> schema = &#123;</span><br><span class="line">  _id: &#123;</span><br><span class="line">    type: <span class="built_in">String</span>,</span><br><span class="line">    optional: <span class="literal">true</span>,</span><br><span class="line">    canRead: [<span class="string">'guests'</span>],</span><br><span class="line">  &#125;,</span><br><span class="line">  </span><br><span class="line">  <span class="comment">//...</span></span><br><span class="line"></span><br><span class="line">  addresses: &#123;</span><br><span class="line">    type: <span class="built_in">Array</span>,</span><br><span class="line">    canRead: [<span class="string">'guests'</span>],</span><br><span class="line">    canCreate: [<span class="string">'members'</span>],</span><br><span class="line">    canUpdate: [<span class="string">'members'</span>],</span><br><span class="line">    resolveAs: &#123;</span><br><span class="line">        type: <span class="string">'[CustomerAddresses]'</span>,</span><br><span class="line">        resolver: <span class="function"><span class="params">customer</span> =&gt;</span> &#123;</span><br><span class="line">          <span class="keyword">return</span> getAddresses(customer);</span><br><span class="line">        &#125;,</span><br><span class="line">      &#125;,</span><br><span class="line">    &#125;,</span><br><span class="line">  &#125;,</span><br><span class="line"></span><br><span class="line">  <span class="string">'addresses.$'</span>: &#123;</span><br><span class="line">    type: addressSchema,</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<h3 id="Disabling-Nested-GraphQL-Schemas"><a href="#Disabling-Nested-GraphQL-Schemas" class="headerlink" title="Disabling Nested GraphQL Schemas"></a>Disabling Nested GraphQL Schemas</h3><p>If you’d like to use a nested schema for validation purposes but <em>don’t</em> want to generate the corresponding GraphQL type, you can set the <code>blackbox: true</code> option on the field that has the nested schema:</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> customerSchema = &#123;</span><br><span class="line">  _id: &#123;</span><br><span class="line">    type: <span class="built_in">String</span>,</span><br><span class="line">    canRead: [<span class="string">'guests'</span>],</span><br><span class="line">  &#125;,</span><br><span class="line">  name: &#123;</span><br><span class="line">    type: <span class="built_in">String</span>,</span><br><span class="line">    canRead: [<span class="string">'guests'</span>],</span><br><span class="line">  &#125;,</span><br><span class="line">  addresses: &#123;</span><br><span class="line">    type: <span class="built_in">Array</span>,</span><br><span class="line">    canRead: [<span class="string">'guests'</span>],</span><br><span class="line">    blackbox: <span class="literal">true</span></span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="string">'addresses.$'</span>: &#123;</span><br><span class="line">    type: addressSchema,</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
    </div>
  </div>

  <div class="pagination">
    <div class="content-wrapper">
      
      
        <a class="link primary prev" href="toc.html">
          <span class="icon-arrow-left-alt"></span>
          <span class="subtitle-pagination">Previous</span>
          Table of Contents
        </a>
      
      
        <a class="link primary next" href="schema-properties.html">
          <span class="subtitle-pagination">Next</span>
          Schema Properties
          <span class="icon-arrow-right-alt"></span>
        </a>
      
    </div>
  </div>

  <div class="github">
    <a class="link tertiary " href="https://github.com/vulcanjs/vulcan-docs/tree/master/source/schemas.md" target="_blank">
      <span class="icon-github"></span>Edit on GitHub</a>
  </div>

  
</div>

    <script src="/script/smooth-scroll.min.js"></script>
    <script src="/script/main.js"></script>
    <script>
      
    </script>

    <script type="text/javascript" src="https://cdn.jsdelivr.net/docsearch.js/2/docsearch.min.js"></script>
    <script type="text/javascript"> docsearch({
      apiKey: 'ab091fbd89cda3abd54a35c4441b3e9b',
      indexName: 'vulcanjs',
      inputSelector: '#desktop-search-input',
      debug: true // Set debug to true if you want to inspect the dropdown
    });
    </script>

  </body>
</html>
